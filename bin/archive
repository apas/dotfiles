#!/usr/bin/env bash

url=${1}
domain=$(echo ${url#*//} | tr / -)
ts=$(date +"%Y-%m-%d-%H-%M-%S")
wd=/Users/apas/Dropbox/Archive

if [[ "${url}" == *"https://twitter.com"*  ]]; then
    url="$(echo ${url/twitter.com/nitter.it})"
fi

wget -k \
    --html-extension \
    --span-hosts \
    â€“user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36." \
    -e robots=off \
    -P ${wd} \
    -q \
    ${url}

ls -rt ${wd} \
    | tail -n 1 \
    | xargs -I '{}' mv ${wd}/'{}' ${wd}/${ts}-${domain}.html
